package ar.edu.ungs.prog2.ticketek;

import java.time.LocalDate;
import java.time.format.DateTimeFormatter;
import java.util.HashSet;
import java.util.LinkedHashSet;

public class Espectaculo {

	String nombre;
	LinkedHashSet<Funcion> funciones;
	DateTimeFormatter formatter = DateTimeFormatter.ofPattern("dd/MM/yy");

	Espectaculo(String nombre){

		this.nombre = nombre;
		this.funciones = new LinkedHashSet<>();;
	}

	@Override 
	public String toString() {

		StringBuilder info = new StringBuilder();

		for (Funcion fun : funciones) {
			String infoFuncion = fun.toString();			
			info.append(infoFuncion);
			info.append("\n");
		}
		return info.toString();

	}

	public boolean fechaDisponible(String fecha, Sede sede){

		for (Funcion fun : funciones) {
			if (fun.fecha.equals(LocalDate.parse(fecha)) && fun.sede.equals(sede))
				return false;
		}
		return true;
	}

	void agregarFuncion(Funcion funcion) {

		for (Funcion fun : funciones) {
			if (fun.fecha.equals(funcion.fecha) && fun.sede.equals(funcion.sede))
				throw new RuntimeException ("La sede no esta disponible en la fecha indicada");
		}		
		funciones.add(funcion);
	}

	Sede getSedeFuncion(String fecha){

		LocalDate date = LocalDate.parse(fecha,formatter);
		for (Funcion funcion : funciones) {
			if (funcion.fecha.equals(date)) {
				return funcion.sede;
			}
		}
		return null;
	}

}
